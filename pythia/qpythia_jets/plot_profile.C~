{
  Float_t min_pt = 20;
  Float_t max_pt = 40;
  Float_t max_deta = 0.2; // also used for other projection, max_dphi
  Float_t Rval = 0.2;

  TFile *fin_qpythia = new TFile("pythia_charged_jet_spectra_2760GeV_0_merged.root");
  //TFile *fin_qpythia = new TFile("output/pythia_charged_jet_spectra_2760GeV_40_100_0_all.root");
  //TFile *fin_qpythia = new TFile("output/pythia_charged_jet_spectra_2760GeV_40_100_0_9145417.root");
  //TFile *fin_qpythia = new TFile("qPythiaJetSpectra.root");
  
  TCanvas *c1 = new TCanvas("c1","c1: spectra");
  h3DSpecPythia = (TH3F*) fin_qpythia->Get("hLeadJetPtEtaPhi_R2");
  hJetPtPythia = h3DSpecPythia->Project3D("x");
  hJetPtPythia->Draw();
  gPad->SetLogy();

  TCanvas *c2 = new TCanvas("c2","c2: dphi");

  //h3DPythia = (TH3F*) fin_qpythia->Get("hPtJetDeltaEtaDeltaPhiN_R2");
  h3DPythia = (TH3F*) fin_qpythia->Get("hPtJetDeltaEtaDeltaPhiPt_R2");

  h3DPythia->GetXaxis()->SetRange( h3DPythia->GetXaxis()->FindBin(min_pt+0.001),  h3DPythia->GetXaxis()->FindBin(max_pt-0.001)); 
  h3DPythia->GetYaxis()->SetRange( h3DPythia->GetYaxis()->FindBin(-max_deta+0.001),  h3DPythia->GetYaxis()->FindBin(max_deta-0.001)); 
  h2=h3DPythia->Project3D("z");
  Float_t njet_pythia = hJetPtPythia->Integral(hJetPtPythia->FindBin(min_pt+0.001),hJetPtPythia->FindBin(max_pt-0.001)); 
  cout << "njet_pythia " << njet_pythia << endl;
  h2->Scale(1./ njet_pythia / h2->GetBinWidth(1));
  h2->Draw();
  cout << "PYTHIA dphi integral in R " << h2->Integral( h2->FindBin(-Rval+0.001),h2->FindBin(Rval-0.001))*h2->GetBinWidth(1) << endl;

 TCanvas *c3 = new TCanvas("c3","c3: deta");

  h3DPythia->GetYaxis()->SetRange( 1,h3DPythia->GetYaxis()->GetNbins());
  h3DPythia->GetZaxis()->SetRange(h3DPythia->GetZaxis()->FindBin(-max_deta+0.001),  h3DPythia->GetZaxis()->FindBin(max_deta-0.001)); 
  h2=h3DPythia->Project3D("y");
  h2->Scale(1./ njet_pythia / h2->GetBinWidth(1));
  h2->Draw();
  cout << "PYTHIA deta integral in R " << h2->Integral(47,54)*h2->GetBinWidth(1) << endl;

}
